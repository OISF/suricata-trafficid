# TLS SNI patterns.
tls-sni-patterns:

  # Bing.
  - id: bing
    labels:
      - search
    patterns:
      - bing.com

  # Facebook.
  - id: facebook
    labels:
      - social-network
    patterns:
      - facebook.com
      - facebook.net
      - fbcdn.net
      - fbcdn.com
      - fbsbx.com

  # Facebook Messenger.
  - id: facebook-messenger
    labels:
      - im
    patterns:
      - edge-chat.facebook.com

  # Gmail POP
  - id: gmail
    labels:
      - mail
      - pop3
    patterns:
      - pop.gmail.com
    ports:
      - 993

  # Google.
  - id: google
    labels:
      - search
    patterns:
      - google.com
      - googleapis.com
      - googlevideo.com
      - googleusercontent.com
      - google.cz
      - gstatic.com

  # Google Video (youtube, etc.)
  - id: google-video
    labels:
      - video
    patterns:
      - googlevideo.com

  - id: google-tracking
    labels:
      - tracking
      - stats
    patterns:
      - www.google-analytics.com

  - id: google-ads
    labels:
      - tracking
      - ads
    patterns:
      - .doubleclick.net
      - www.googleadservices.com

  # IRCCloud
  - id: irccloud
    label: im
    patterns:
      - irccloud.com

  # Lastpass.
  - id: lastpass
    labels:
      - password-management
    patterns:
      - lastpass.com

  # Signal chat.
  - id: whisper
    labels:
      - im
    patterns:
      - whispersystems.org

  # Netflix
  - id: netflix
    labels:
      - video
    patterns:
      - netflix.com
      - nflxso.net
      - nflxext.com
      - nflxvideo.net

  # Skype
  - id: skype
    labels:
      - im
    patterns:
      - skype.com
      - skypeassets.com

  # Snapchat.
  - id: snapchat
    labels:
      - im
    patterns:
      - feelinsonice.appspot.com
      - feelinsonice-hrd.appspot.com
      - snapchat.com

  # Spotify
  - id: spotify
    labels:
      - music
    patterns:
      - spclient.wg.spotify.com
      - api-partner.spotify.com
      - scdn.co

  - id: mixcloud
    labels:
      - music
      - streaming
    patterns:
      - mixcloud.com

  # Twitter
  - id: twitter
    labels:
      - social-network
    patterns:
      - twitter.com
      - twimg.com

  # Whatsapp
  - id: whatsapp
    labels:
      - im
      - file-transfer
    patterns:
      - whatsapp.com

  # Instagram
  - id: instagram
    labels:
      - social-network
    patterns:
      - instagram.com
      - cdninstagram.com

  - id: feedly
    labels:
      - news
      - rss
    patterns:
      - feedly.com

  - id: nos
    labels:
      - news
    patterns:
      - nos.nl

  - id: chartbeat
    labels:
      - stats
      - tracking
    patterns:
      - chartbeat.net

  - id: github
    labels:
      - dev
    patterns:
      - github.com

  - id: github-tracking
    labels:
      - dev
      - stats
      - tracking
    patterns:
      - collector.githubapp.com

  - id: mozilla
    labels:
      - browser
    patterns:
      - firefoxusercontent.com
      - services.mozilla.com

  - id: rememberthemilk
    labels:
      - todo
    patterns:
      - rememberthemilk.com

  - id: docker
    labels:
      - devops
    patterns:
      - registry-1.docker.io
      - auth.docker.io

  - id: rust-lang
    labels:
      - dev
    patterns:
      - static.crates.io

  - id: oisf-dev-infra
    labels:
      - dev
    patterns:
      - buildbot.openinfosecfoundation.org

  - id: apple
    labels:
      - software-update
    patterns:
      - .push.apple.com

  - id: apple-icloud
    labels:
      - cloud
    patterns:
      - setup.icloud.com

# Traffic identification where more than simple lists of a specific
# pattern are required.
rules:

  # Debian APT-GET
  - id: debian-apt
    msg: "Debian APT-GET"
    labels:
      - software-update
    proto: http
    http_host: debian.org
    http_user_agent: Debian APT

  # Ubuntu APT-GET
  - id: ubuntu-apt
    msg: "Ubuntu APT-GET"
    labels:
      - software-update
    proto: http
    http_host: ubuntu.com
    http_user_agent: Debian APT

  # Ubuntu Updater
  - id: ubuntu-swupdate
    msg: "Ubuntu Software-Update"
    labels:
      - software-update
    proto: http
    http_host: changelogs.ubuntu.com
    http_user_agent: Python-urllib/3.5

  # Steam Game downloads
  - id: steam
    msg: "Steam"
    labels:
      - game
    proto: http
    http_host: .steamcontent.com
    http_user_agent: Valve/Steam HTTP Client

# Map short ID names to full names (or description)
id-map:
  bing: Bing
  facebook: Facebook
  facebook-messenger: Facebook Messenger
  google: Google Search and Other Services
  irccloud: IRCCloud
  lastpass: Lastpass
  netflix: Netflix
  skype: Skype
  snapchat: Snapchat
  spotify: Spotify
  twitter: Twitter
  whatsapp: WhatsApp Messenger
  whisper: Signal messaging application
  xmarks: XMarks
  instagram: Instagram

# Map labels to a description.
labels:
  social-network: Social Network
  chat: Chat
  file-transfer: File Transfer
  im: Instant Messaging
  music: Music Stream Service
  video: Video Stream Service
