# TLS SNI patterns.
tls-sni-patterns:

  # Bing.
  - flowbit:
      - traffic/id/bing
    patterns:
      - bing.com

  # Facebook
  - flowbit:
      - traffic/id/facebook
      - traffic/label/social-network
    patterns:
      - facebook.com
      - fbcdn.net
      - fbsbx.com
  - flowbit:
      - traffic/id/facebook-messenger
      - traffic/label/im
    patterns:
      - edge-chat.facebook.com

  # Google.
  - flowbit:
      - traffic/id/google
    patterns:
      - google.com
      - googleapis.com
      - googlevideo.com
      - googleusercontent.com
      - google.cz
      - gstatic.com

  # Google Video (youtube, etc.)
  - flowbit:
      - traffic/id/google
      - traffic/label/video
    patterns:
      - googlevideo.com

  # IRCCloud
  - flowbit:
      - traffic/id/irccloud
    patterns:
      - irccloud.com

  # Lastpass.
  - flowbit:
      - traffic/id/lastpass
    patterns:
      - lastpass.com

  # Signal chat.
  - flowbit:
      - traffic/id/whisper
    patterns:
      - whispersystems.org

  # Netflix
  - flowbit:
      - traffic/id/netflix
      - traffic/label/video
    patterns:
      - netflix.com
      - nflxso.net
      - nflxext.com
      - nflxvideo.net
      
  # Skype
  - flowbit:
      - traffic/id/skype
    patterns:
      - skype.com
      - skypeassets.com

  # Snapchat.
  - flowbit:
      - traffic/id/snapchat
    patterns:
      - feelinsonice.appspot.com
      - feelinsonice-hrd.appspot.com
      - snapchat.com

  # Twitter
  - flowbit:
      - traffic/id/twitter
      - traffic/label/social-network
    patterns:
      - twitter.com
      - twimg.com

  # Whatsapp
  - flowbit:
      - traffic/id/whatsapp
      - traffic/label/im
      - traffic/label/file-transfer
    patterns:
      - whatsapp.com

# Traffic identification where more than simple lists of a specific
# pattern are required.
rules:

  # Debian APT-GET
  - msg: "Debian APT-GET"
    flowbit:
      - traffic/id/debian-apt
      - traffic/label/software-update
    proto: http
    http_host: debian.org
    http_user_agent: Debian APT

  # Ubuntu APT-GET
  - msg: "Ubuntu APT-GET"
    flowbit:
      - traffic/label/software-update
      - traffic/id/ubuntu-apt
    proto: http
    http_host: ubuntu.com
    http_user_agent: Debian APT

# Map short ID names to full names (or description)
id-map:
  bing: Bing
  facebook: Facebook
  facebook-messenger: Facebook Messenger
  google: Google Search and Other Services
  irccloud: IRCCloud
  lastpass: Lastpass
  netflix: Netflix
  skype: Skype
  snapchat: Snapchat
  twitter: Twitter
  whatsapp: WhatsApp Messenger
  whisper: Signal messaging application
  xmarks: XMarks

# Map labels to a description.
labels:
  social-network: Social Network
  chat: Chat
  file-transfer: File Transfer
  im: Instant Messaging
  video: Video Stream Service
